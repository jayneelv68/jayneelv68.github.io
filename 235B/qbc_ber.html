<html>
<title>
Quantum Bit Commitment.
</title>
<script>
var seq="";
function gen_rect_basis(){
var str="";
document.getElementById("abasis").value='+' ;
}
function gen_diag_basis(){
var str="";
document.getElementById("abasis").value='x' ;
}

function gen_rand_basis(){
var str="";
document.getElementById("abasis").value=['x','+'][Math.floor(Math.random() * 2)];
}

function generate_bits() {
var str="";
var s=document.getElementById("param_s").value ;
for(var i=1;i<=s;i++)
{
str+=['0','1'][Math.floor(Math.random() * 2)];

}
document.getElementById("abits").value = str;
}
function a_put_cc(){
document.getElementById("pchannel").value=document.getElementById("abits").value;
}
function b_get_cc(){
document.getElementById("bbits").innerHTML=document.getElementById("pchannel").value;
}

function a_encode() {

var s=document.getElementById("param_s").value;
var bits=document.getElementById("abits").value.split("");

basis= document.getElementById("abasis").value;
var enc="";
for(var i=0;i<s;i++){ 
if (bits[i]=='0'){ 
	if (basis=='+'){enc+="H";}
	else{enc+="D";}}
else{
if (basis=='+'){enc+="V";}
	else{enc+="A";}
}

}
  document.getElementById("aencode").value =enc;
}


function occurences(str, letter) {
    let count = 0;

    // looping through the items
    for (let i = 0; i < str.length; i++) {

        // check if the character is at that position
        if (str.charAt(i) == letter) {
            count += 1;
        }
    }
    return count;
}


function bgenerate_basis() {
var str="";
var s=document.getElementById("param_s").value ;
var flag=0;
while(flag==0){
str="";
for(var i=1;i<=s;i++)
{
str+=['x','+'][Math.floor(Math.random() * 2)];

}
if(occurences(str,'x')!==occurences(str,'+')){flag=1;}
}
  document.getElementById("bbasis").value = str;
}

function b_decode() {
seq="";
bits=document.getElementById("recieved").value.split("");
basis= document.getElementById("bbasis").value.split("");
var encr="";
var encd="";
var diag=0;
var rect=0;
enc="";
for(var i=0;i<bits.length;i++){ 
if (bits[i]=='D')
	{ 
		if (basis[i]=='+')
		{
			if(Math.random()>0.5)
				{encr+="0<br>";
				encd+="-<br>";
				rect+=1;
				diag+=0;
				seq+="0";				}
			else
				{encr+="-<br>";
				encd+="-<br>";
				rect+=0;
				diag+=0;
				seq+=" ";}
		}
else{encd+="0<br>";
encr+=" <br>";
				seq+="0";

				rect+=0;
				diag+=1;}
}

else if (bits[i]=='V'){ 
		if (basis[i]=='+'){encr+="1<br>";
							encd+="-<br>";
				rect+=1;
				diag+=0;
				seq+="1";}
		else{ 
			if(Math.random()>0.5){encd+="1<br>";
			encr+="-<br>";
				rect+=0;
				diag+=1;
				seq+="1";}
			else{encd+="-<br>";
			encr+="-<br>";
				rect+=0;
				diag+=0;
				seq+=" ";}
			}
			}
			
else if (bits[i]=='H'){ 

		if (basis[i]=='+'){encr+="0<br>";
							encd+="-<br>";
				seq+="0";}
		else{ 
			if(Math.random()>0.5){encd+="0<br>";
			encr+=" <br>";
				rect+=0;
				diag+=1;
				seq+="0";}
			else{encd+="-<br>";
			encr+="-<br>";
				rect+=0;
				diag+=0;
				seq+=" ";}
			}
	}

else{


		if (basis[i]=='+')
		{
			if(Math.random()>0.5)
				{encr+="1<br>";
				encd+="-<br>";
				rect+=1;
				diag+=0;
				seq+="1";}
			else
				{encr+="-<br>";
				encd+="-<br>";
				rect+=0;
				diag+=0;
				seq+=" ";}
		}
else{encd+="1<br>";
encr+="-<br>";
				rect+=0;
				diag+=1;
				seq+="1";}

}
}
  document.getElementById("bdecode+").innerHTML =encr;
  
  document.getElementById("bdecodex").innerHTML =encd;
  if (diag>rect){document.getElementById("guess").value="x";}
  else{document.getElementById("guess").value="+";}
}
function zgenerate_bit(){
document.getElementById("bit").value=0;
}

function ogenerate_bit(){
document.getElementById("bit").value=1;
}
function rgenerate_bit(){
var val=0;
if(Math.random()>0.5){val=1;}
document.getElementById("bit").value=val;
}


function asend_bits(){

document.getElementById("qchannel").value =document.getElementById("aencode").value;
}
function b_read_qc(){
document.getElementById("recieved").value =document.getElementById("qchannel").value;
}

function b_verify(){
console.log(seq);
var bob=seq.split("");
var alice=document.getElementById("bbits").innerHTML.split("");
console.log(bob);
console.log(alice);
var flag="True;"
for(var i=0;i<bob.length;i++)
{    console.log(i,alice[i],bob[i],flag);
	if(bob[i]!=" ")
	{
		if (alice[i]!==bob[i])
		{ flag="False"; break;}

	}
}
document.getElementById("verify").innerHTML=flag;
}
</script>

<body>
<a href="235b.html">Home</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="b84.html">BB84 protocol</a><tab>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="b92.html">B92 protocol </a><t>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="qbc_ber.html">Quantum Bit Commitment </a>

<table border="2">

<tr>
	<td>Alice</td>
	<td>Bob</td>
</tr>

<tr>
	<td colspan="2">Agreed value of s is<input type="text" id="param_s" value="10"> .</td>
</tr>

<tr>
	<td>Choose basis <button onclick="gen_rect_basis()">Rectilinear</button> or <button onclick="gen_diag_basis()">Diagnol</button> or <button onclick="gen_rand_basis()">random</button><br>
	Chosen basis: <input type="text" id="abasis" > </td>
	<td></td>
</tr>

<tr>
	<td> <button onclick="generate_bits()">generate bits</button> <br>
	 display bits<br> <input type="text" id="abits"> </td> 
	 <td></td> 

</tr>
<tr>
	<td> <button onclick="a_encode()">encode onto polarization</button>     
	<br>encoded bits to send:<br> <input type="text" id="aencode"> </td>  <td>  </td> 
</tr>

<tr> 
	<td> <button onclick="asend_bits()">send encoded bits via quantum channel.</button>  </td>      
	<td>  </td>
</tr>

<tr>
	<td colspan="2" style="text-align: center; "">Classical CHANNEL:<input type="text" id="pchannel"></td>
</tr>

<tr>
	<td colspan="2" style="text-align: center; ""> QUANTUM CHANNEL:<input type="text" id="qchannel"></td>
</tr>

<tr>
	<td></td>
	<td><button onclick="b_read_qc()">read encoding from channel</button></td>
<tr>	
	<td></td>
	<td> Recieved polarization<br>
	<input type="text" id="recieved"></td> 
</tr>
<tr>	
	<td></td>
	<td>
		<button onclick="bgenerate_basis()">create random basis</button><br>
			display basis<br> <input type="text" id="bbasis"> <br>
			<button onclick="b_decode()">decode polarizations</button> <br>
			<table>
				<tr><td>RL</td><td>Di</td></tr>
				<tr><td id="bdecode+"></td><td id="bdecodex"></td></tr>
			</table>
		Guess:<input type="text" id="guess">
	</td>
</tr>
<tr>
 <td><button onclick="a_put_cc()">Announce original bit sequence</button></td>
 <td> <button onclick="b_get_cc()">Read the classical channel</button>
 <p id="bbits"></p></td>
</tr>
<tr>
 <td></td>
 <td> <button onclick="b_verify()">Verify with Bob's sequence</button>
  <p id="verify"></p></td>
</tr>
 </table>
</body>
</html>
